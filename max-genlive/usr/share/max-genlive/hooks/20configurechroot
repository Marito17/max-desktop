
_echo "Configurando DNS del chroot y nuevo sources.list"

cp /etc/resolv.conf $CHROOT/etc/

if [ $LOCAL_MIRROR ]; then
     _echo " ****** sources.list ***** Usando mirror local => $MIRROR"
     cat << EOF > $CHROOT/etc/apt/sources.list
deb http://$MIRROR/mirror/ubuntu ${DISTRO} main universe multiverse restricted
deb http://$MIRROR/mirror/ubuntu ${DISTRO}-updates main universe multiverse restricted
deb http://$MIRROR/mirror/ubuntu ${DISTRO}-security main universe multiverse restricted

deb http://$MIRROR/mirror/max40 max main

EOF
else
     cp $GENLIVE/sources.list $CHROOT/etc/apt/
fi

mount --bind /proc $CHROOT/proc
mount --bind /sys   $CHROOT/sys

# se necesita para ebeam-driver (luego se borra)
touch $CHROOT/etc/X11/xorg.conf

cat << EOF > $CHROOT/etc/apt/preferences
Package: openoffice.org
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-base
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-base-core
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-calc
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-common
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-core
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-draw
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-filter-binfilter
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-filter-mobiledev
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-gnome
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-gtk
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-help-en-gb
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-help-en-us
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-help-es
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-impress
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-java-common
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-kde
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-l10n-common
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-l10n-en-gb
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-l10n-en-za
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-l10n-es
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-math
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-officebean
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-presentation-minimizer
Pin: version 1.0+OOo2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-style-crystal
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-style-human
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: openoffice.org-writer
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: python-uno
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: ttf-opensymbol
Pin: version 1:2.4.1-1ubuntu2.1
Pin-Priority: 1001

Package: ure
Pin: version 1.4+OOo2.4.1-1ubuntu2.1
Pin-Priority: 1001
EOF

_echo "Configurando DEBCONF: licencia JAVA..."
chroot $CHROOT debconf-set-selections << EOF || _exit "No se ha podido aceptar la licencia JAVA"
sun-java5-bin   shared/accepted-sun-dlj-v1-1    boolean true
sun-java5-jdk   shared/accepted-sun-dlj-v1-1    boolean true
sun-java5-jre   shared/accepted-sun-dlj-v1-1    boolean true
sun-java6-bin   shared/accepted-sun-dlj-v1-1    boolean true
sun-java6-jre   shared/accepted-sun-dlj-v1-1    boolean true
sun-java6-jdk   shared/accepted-sun-dlj-v1-1    boolean true
tzdata  tzdata/Areas    select  Europe
tzdata  tzdata/Zones/Europe     select  Madrid
EOF

echo "Europe/Madrid" > $CHROOT/etc/timezone

chroot $CHROOT/ << EOF || _exit "Error configurando zona horaria Europe/Madrid"
export LC_ALL=C
export LC_MESSAGES=C
export DEBCONF_FRONTEND="noninteractive"
export DEBIAN_FRONTEND="noninteractive"
dpkg-reconfigure tzdata
EOF

#xserver-xorg    xserver-xorg/config/inputdevice/keyboard/layout string es
#xserver-xorg    xserver-xorg/config/inputdevice/keyboard/model  string pc105
# not work
#console-setup	console-setup/variant	select	Spain
#console-setup	console-setup/layoutcode	string	es
#console-setup	console-setup/charmap	select	UTF-8
#console-setup	console-setup/fontsize-text	select	16
#console-setup	console-setup/layout	select	Spain
#console-setup	console-setup/variantcode	string	
#console-setup	console-setup/codesetcode	string	Uni1
#console-setup	console-setup/modelcode	string	pc105
#console-setup	console-setup/altgr	select	No AltGr key
#console-setup	console-setup/ttys	string	/dev/tty[1-6]
#console-setup	console-setup/model	select	Generic 105-key (Intl) PC
#console-setup	console-setup/fontsize-fb	select	16
#console-setup	console-setup/fontface	select	Fixed
#console-setup	console-setup/fontsize	string	16
#EOF
